#include <msp430.h>

void main(void)
{
    WDTCTL = WDTPW | WDTHOLD;     // Stop watchdog timer

    PM5CTL0 &= ~LOCKLPM5;         // Unlock GPIO

    P1DIR |= BIT0;                // P1.0 LED output
    P1OUT &= ~BIT0;

    P2DIR &= ~BIT1;               // P2.1 as input (IR receiver OUT)
    P2REN |= BIT1;                // Enable pull-up/down
    P2OUT |= BIT1;                // Pull-up

    P2IES |= BIT1;                // Falling edge
    P2IFG &= ~BIT1;               // Clear flag
    P2IE  |= BIT1;                // Enable interrupt

    __enable_interrupt();

    while(1) {
        __no_operation();         // Low power
    }
}

#pragma vector=PORT2_VECTOR
__interrupt void Port_2(void)
{
    if (P2IFG & BIT1) {
        P1OUT ^= BIT0;            // Toggle LED on IR pulse
        P2IFG &= ~BIT1;           // Clear flag
    }
}
